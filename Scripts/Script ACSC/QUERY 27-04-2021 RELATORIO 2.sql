SELECT 
PORTA_ATENDIMENTO,
CD_PRO_FAT,
CD_TUSS,
DS_TUSS,
COUNT(*)QUANT_LANCADA

FROM
(
SELECT 
DISTINCT 
'INTERNADO'PORTA_ATENDIMENTO,
RF.CD_REG_FAT CONTA,
IRF.CD_PRO_FAT ,
TS.CD_TUSS,
TS.DS_TUSS,
IRF.QT_LANCAMENTO,
IRF.DT_LANCAMENTO,
IRF.VL_TOTAL_CONTA
FROM REG_FAT RF 
INNER JOIN ITREG_FAT IRF ON IRF.CD_REG_FAT = RF.CD_REG_FAT
INNER JOIN TUSS TS ON TS.CD_PRO_FAT = IRF.CD_PRO_FAT 
WHERE RF.CD_CONVENIO = 11
AND IRF.CD_PRO_FAT IN ('40314057' 
,'40503062' 
,'40503097' 
,'40701069' 
,'40701131' 
,'40701140' 
,'40301982' 
,'40306887' 
,'40304493' 
,'40501019' 
,'40501078' 
,'40501183' 
,'40501191' 
,'40501230' 
,'40302610' 
,'40502074' 
,'40502090' 
,'40503011' 
,'40503020' 
,'40503046' 
,'40503054' 
,'40503089' 
,'40503151' 
,'40503348' 
,'40503356' 
,'40503372' 
,'40503445' 
,'30912156' 
,'40503640' 
,'40503771' 
,'40503836' 
,'40503844' 
,'40309266' 
,'40101037' 
,'41401174' 
,'40311465' 
,'40312020' 
,'40312127' 
,'40312143' 
,'40314022' 
,'40314081' 
,'40314090' 
,'40314103' 
,'20102038' 
,'40314251' 
,'40314413' 
,'40314430' 
,'40323552' 
,'40503682' 
,'40503682' 
,'40304906' 
,'40304906' 
,'40304906' 
,'40304779' 
,'40502171' 
,'40503011' 
,'40503062' 
,'40503097' 
,'40701069' 
,'40503020' 
,'40701131' 
,'40701140' 
,'40503640' 
,'40503771' 
,'40503836' 
,'40503844' 
,'30911117' 
,'40314057' 
,'30912156' 
,'40309266' 
,'40301982' 
,'40503046' 
,'40503054' 
,'40503089' 
,'40503151' 
,'40503348' 
,'40503356' 
,'40503372' 
,'40503445' 
,'40306887' 
,'40501019' 
,'40501078' 
,'40501183' 
,'40501191' 
,'40501230' 
,'40502074' 
,'40502090' 
,'41401174' 
,'40311465' 
,'40312020' 
,'40312127' 
,'40312143'
,'40314022'
,'40314081'
,'40314090'
,'40314103'
,'20102038'
,'40314251'
,'40314413'
,'40314430'
,'40323552'
,'40302610'
,'40101037'
,'40304493'
,'40304906'
,'10001526'
,'10001527'
,'10001528'
,'30911117'
,'30911117'
,'40301982'
,'40302610'
,'40304493'
,'40304906'
,'41401174'
,'40311465'
,'40312020'
,'40312127'
,'40312143'
,'40306887'
,'40314022'
,'40314057'
,'40314081'
,'40314090'
,'40314103'
,'20102038'
,'40314251'
,'40314286'
,'40314413'
,'40314430'
,'40323552'
,'40309266'
,'40501019'
,'40501078'
,'40501183'
,'40501191'
,'40502074'
,'40502090'
,'40502171'
,'40503011'
,'40503020'
,'40503046'
,'40503054'
,'40503089'
,'40503151'
,'40101037'
,'30912156'
,'40503062'
,'40503097'
,'40701069'
,'40701131'
,'40701140'
,'40314057'
,'40314057'
,'40304779'
,'40101037'
,'30911117'
,'40302610'
,'40314103'
,'20102038'
,'40101037'
,'40502171'
,'10055556'
,'40314286'
,'40314430')
AND TRUNC(IRF.DT_LANCAMENTO) BETWEEN '01/01/2020' AND '01/01/2021'
AND (TS.CD_CONVENIO = 11 OR TS.CD_CONVENIO IS NULL)
AND (TS.CD_MULTI_EMPRESA = 7 OR TS.CD_MULTI_EMPRESA IS NULL)

UNION ALL

SELECT 
'AMBULATORIAL'PORTA_ATENDIMENTO,
RAMB.CD_REG_AMB CONTA,
IRAMB.CD_PRO_FAT,
TS1.CD_TUSS,
TS1.DS_TUSS,
IRAMB.QT_LANCAMENTO,
IRAMB.HR_LANCAMENTO DT_LANCAMENTO,
IRAMB.VL_TOTAL_CONTA
FROM REG_AMB RAMB
INNER JOIN ITREG_AMB IRAMB ON IRAMB.CD_REG_AMB = RAMB.CD_REG_AMB
INNER JOIN TUSS TS1 ON TS1.CD_PRO_FAT = IRAMB.CD_PRO_FAT
WHERE RAMB.CD_CONVENIO = 11
AND IRAMB.CD_PRO_FAT IN ('40314057' 
,'40503062' 
,'40503097' 
,'40701069' 
,'40701131' 
,'40701140' 
,'40301982' 
,'40306887' 
,'40304493' 
,'40501019' 
,'40501078' 
,'40501183' 
,'40501191' 
,'40501230' 
,'40302610' 
,'40502074' 
,'40502090' 
,'40503011' 
,'40503020' 
,'40503046' 
,'40503054' 
,'40503089' 
,'40503151' 
,'40503348' 
,'40503356' 
,'40503372' 
,'40503445' 
,'30912156' 
,'40503640' 
,'40503771' 
,'40503836' 
,'40503844' 
,'40309266' 
,'40101037' 
,'41401174' 
,'40311465' 
,'40312020' 
,'40312127' 
,'40312143' 
,'40314022' 
,'40314081' 
,'40314090' 
,'40314103' 
,'20102038' 
,'40314251' 
,'40314413' 
,'40314430' 
,'40323552' 
,'40503682' 
,'40503682' 
,'40304906' 
,'40304906' 
,'40304906' 
,'40304779' 
,'40502171' 
,'40503011' 
,'40503062' 
,'40503097' 
,'40701069' 
,'40503020' 
,'40701131' 
,'40701140' 
,'40503640' 
,'40503771' 
,'40503836' 
,'40503844' 
,'30911117' 
,'40314057' 
,'30912156' 
,'40309266' 
,'40301982' 
,'40503046' 
,'40503054' 
,'40503089' 
,'40503151' 
,'40503348' 
,'40503356' 
,'40503372' 
,'40503445' 
,'40306887' 
,'40501019' 
,'40501078' 
,'40501183' 
,'40501191' 
,'40501230' 
,'40502074' 
,'40502090' 
,'41401174' 
,'40311465' 
,'40312020' 
,'40312127' 
,'40312143'
,'40314022'
,'40314081'
,'40314090'
,'40314103'
,'20102038'
,'40314251'
,'40314413'
,'40314430'
,'40323552'
,'40302610'
,'40101037'
,'40304493'
,'40304906'
,'10001526'
,'10001527'
,'10001528'
,'30911117'
,'30911117'
,'40301982'
,'40302610'
,'40304493'
,'40304906'
,'41401174'
,'40311465'
,'40312020'
,'40312127'
,'40312143'
,'40306887'
,'40314022'
,'40314057'
,'40314081'
,'40314090'
,'40314103'
,'20102038'
,'40314251'
,'40314286'
,'40314413'
,'40314430'
,'40323552'
,'40309266'
,'40501019'
,'40501078'
,'40501183'
,'40501191'
,'40502074'
,'40502090'
,'40502171'
,'40503011'
,'40503020'
,'40503046'
,'40503054'
,'40503089'
,'40503151'
,'40101037'
,'30912156'
,'40503062'
,'40503097'
,'40701069'
,'40701131'
,'40701140'
,'40314057'
,'40314057'
,'40304779'
,'40101037'
,'30911117'
,'40302610'
,'40314103'
,'20102038'
,'40101037'
,'40502171'
,'10055556'
,'40314286'
,'40314430')
AND TRUNC(IRAMB.HR_LANCAMENTO) BETWEEN '01/01/2020' AND '01/01/2021'
AND (TS1.CD_CONVENIO = 11 OR TS1.CD_CONVENIO IS NULL)
AND (TS1.CD_MULTI_EMPRESA = 7 OR TS1.CD_MULTI_EMPRESA IS NULL)
)GROUP BY 
PORTA_ATENDIMENTO,
CD_PRO_FAT,
CD_TUSS,
DS_TUSS
ORDER BY PORTA_ATENDIMENTO,
         QUANT_LANCADA,
         DS_TUSS
;

SELECT 
DISTINCT 
'INTERNADO'PORTA_ATENDIMENTO,
RF.CD_REG_FAT CONTA,
IRF.CD_PRO_FAT ,
TS.CD_TUSS,
TS.DS_TUSS,
IRF.QT_LANCAMENTO,
IRF.DT_LANCAMENTO,
IRF.VL_TOTAL_CONTA
FROM REG_FAT RF 
INNER JOIN ITREG_FAT IRF ON IRF.CD_REG_FAT = RF.CD_REG_FAT
INNER JOIN TUSS TS ON TS.CD_PRO_FAT = IRF.CD_PRO_FAT 
WHERE RF.CD_CONVENIO = 11
AND IRF.CD_PRO_FAT IN ('40314057' 
,'40503062' 
,'40503097' 
,'40701069' 
,'40701131' 
,'40701140' 
,'40301982' 
,'40306887' 
,'40304493' 
,'40501019' 
,'40501078' 
,'40501183' 
,'40501191' 
,'40501230' 
,'40302610' 
,'40502074' 
,'40502090' 
,'40503011' 
,'40503020' 
,'40503046' 
,'40503054' 
,'40503089' 
,'40503151' 
,'40503348' 
,'40503356' 
,'40503372' 
,'40503445' 
,'30912156' 
,'40503640' 
,'40503771' 
,'40503836' 
,'40503844' 
,'40309266' 
,'40101037' 
,'41401174' 
,'40311465' 
,'40312020' 
,'40312127' 
,'40312143' 
,'40314022' 
,'40314081' 
,'40314090' 
,'40314103' 
,'20102038' 
,'40314251' 
,'40314413' 
,'40314430' 
,'40323552' 
,'40503682' 
,'40503682' 
,'40304906' 
,'40304906' 
,'40304906' 
,'40304779' 
,'40502171' 
,'40503011' 
,'40503062' 
,'40503097' 
,'40701069' 
,'40503020' 
,'40701131' 
,'40701140' 
,'40503640' 
,'40503771' 
,'40503836' 
,'40503844' 
,'30911117' 
,'40314057' 
,'30912156' 
,'40309266' 
,'40301982' 
,'40503046' 
,'40503054' 
,'40503089' 
,'40503151' 
,'40503348' 
,'40503356' 
,'40503372' 
,'40503445' 
,'40306887' 
,'40501019' 
,'40501078' 
,'40501183' 
,'40501191' 
,'40501230' 
,'40502074' 
,'40502090' 
,'41401174' 
,'40311465' 
,'40312020' 
,'40312127' 
,'40312143'
,'40314022'
,'40314081'
,'40314090'
,'40314103'
,'20102038'
,'40314251'
,'40314413'
,'40314430'
,'40323552'
,'40302610'
,'40101037'
,'40304493'
,'40304906'
,'10001526'
,'10001527'
,'10001528'
,'30911117'
,'30911117'
,'40301982'
,'40302610'
,'40304493'
,'40304906'
,'41401174'
,'40311465'
,'40312020'
,'40312127'
,'40312143'
,'40306887'
,'40314022'
,'40314057'
,'40314081'
,'40314090'
,'40314103'
,'20102038'
,'40314251'
,'40314286'
,'40314413'
,'40314430'
,'40323552'
,'40309266'
,'40501019'
,'40501078'
,'40501183'
,'40501191'
,'40502074'
,'40502090'
,'40502171'
,'40503011'
,'40503020'
,'40503046'
,'40503054'
,'40503089'
,'40503151'
,'40101037'
,'30912156'
,'40503062'
,'40503097'
,'40701069'
,'40701131'
,'40701140'
,'40314057'
,'40314057'
,'40304779'
,'40101037'
,'30911117'
,'40302610'
,'40314103'
,'20102038'
,'40101037'
,'40502171'
,'10055556'
,'40314286'
,'40314430')
AND TRUNC(IRF.DT_LANCAMENTO) BETWEEN '01/01/2020' AND '01/01/2021'
AND (TS.CD_CONVENIO = 11 OR TS.CD_CONVENIO IS NULL)
AND (TS.CD_MULTI_EMPRESA = 7 OR TS.CD_MULTI_EMPRESA IS NULL)

UNION ALL

SELECT 
'AMBULATORIAL'PORTA_ATENDIMENTO,
RAMB.CD_REG_AMB CONTA,
IRAMB.CD_PRO_FAT,
TS1.CD_TUSS,
TS1.DS_TUSS,
IRAMB.QT_LANCAMENTO,
IRAMB.HR_LANCAMENTO DT_LANCAMENTO,
IRAMB.VL_TOTAL_CONTA
FROM REG_AMB RAMB
INNER JOIN ITREG_AMB IRAMB ON IRAMB.CD_REG_AMB = RAMB.CD_REG_AMB
INNER JOIN TUSS TS1 ON TS1.CD_PRO_FAT = IRAMB.CD_PRO_FAT 
WHERE RAMB.CD_CONVENIO = 11
AND IRAMB.CD_PRO_FAT IN ('40314057' 
,'40503062' 
,'40503097' 
,'40701069' 
,'40701131' 
,'40701140' 
,'40301982' 
,'40306887' 
,'40304493' 
,'40501019' 
,'40501078' 
,'40501183' 
,'40501191' 
,'40501230' 
,'40302610' 
,'40502074' 
,'40502090' 
,'40503011' 
,'40503020' 
,'40503046' 
,'40503054' 
,'40503089' 
,'40503151' 
,'40503348' 
,'40503356' 
,'40503372' 
,'40503445' 
,'30912156' 
,'40503640' 
,'40503771' 
,'40503836' 
,'40503844' 
,'40309266' 
,'40101037' 
,'41401174' 
,'40311465' 
,'40312020' 
,'40312127' 
,'40312143' 
,'40314022' 
,'40314081' 
,'40314090' 
,'40314103' 
,'20102038' 
,'40314251' 
,'40314413' 
,'40314430' 
,'40323552' 
,'40503682' 
,'40503682' 
,'40304906' 
,'40304906' 
,'40304906' 
,'40304779' 
,'40502171' 
,'40503011' 
,'40503062' 
,'40503097' 
,'40701069' 
,'40503020' 
,'40701131' 
,'40701140' 
,'40503640' 
,'40503771' 
,'40503836' 
,'40503844' 
,'30911117' 
,'40314057' 
,'30912156' 
,'40309266' 
,'40301982' 
,'40503046' 
,'40503054' 
,'40503089' 
,'40503151' 
,'40503348' 
,'40503356' 
,'40503372' 
,'40503445' 
,'40306887' 
,'40501019' 
,'40501078' 
,'40501183' 
,'40501191' 
,'40501230' 
,'40502074' 
,'40502090' 
,'41401174' 
,'40311465' 
,'40312020' 
,'40312127' 
,'40312143'
,'40314022'
,'40314081'
,'40314090'
,'40314103'
,'20102038'
,'40314251'
,'40314413'
,'40314430'
,'40323552'
,'40302610'
,'40101037'
,'40304493'
,'40304906'
,'10001526'
,'10001527'
,'10001528'
,'30911117'
,'30911117'
,'40301982'
,'40302610'
,'40304493'
,'40304906'
,'41401174'
,'40311465'
,'40312020'
,'40312127'
,'40312143'
,'40306887'
,'40314022'
,'40314057'
,'40314081'
,'40314090'
,'40314103'
,'20102038'
,'40314251'
,'40314286'
,'40314413'
,'40314430'
,'40323552'
,'40309266'
,'40501019'
,'40501078'
,'40501183'
,'40501191'
,'40502074'
,'40502090'
,'40502171'
,'40503011'
,'40503020'
,'40503046'
,'40503054'
,'40503089'
,'40503151'
,'40101037'
,'30912156'
,'40503062'
,'40503097'
,'40701069'
,'40701131'
,'40701140'
,'40314057'
,'40314057'
,'40304779'
,'40101037'
,'30911117'
,'40302610'
,'40314103'
,'20102038'
,'40101037'
,'40502171'
,'10055556'
,'40314286'
,'40314430')
AND TRUNC(IRAMB.HR_LANCAMENTO) BETWEEN '01/01/2020' AND '01/01/2021'
AND (TS1.CD_CONVENIO = 11 OR TS1.CD_CONVENIO IS NULL)
AND (TS1.CD_MULTI_EMPRESA = 7 OR TS1.CD_MULTI_EMPRESA IS NULL)
ORDER BY DS_TUSS,DT_LANCAMENTO
