SELECT 
VP.CD_PRO_FAT,
PF.DS_PRO_FAT,
VP.CD_TAB_FAT,
TF.DS_TAB_FAT,
VP.DT_VIGENCIA,
VP.VL_TOTAL
FROM
VAL_PRO VP
INNER JOIN PRO_FAT PF ON PF.CD_PRO_FAT = VP.CD_PRO_FAT
INNER JOIN TAB_FAT TF ON TF.CD_TAB_FAT = VP.CD_TAB_FAT
WHERE VP.DT_VIGENCIA = (SELECT MAX(X.DT_VIGENCIA) FROM VAL_PRO X WHERE X.CD_PRO_FAT = VP.CD_PRO_FAT AND X.CD_TAB_FAT = VP.CD_TAB_FAT)
AND PF.CD_PRO_FAT IN ('02037637','02037623','02037627','02037628','02037629','02037632','03000006') 
AND VP.CD_TAB_FAT IN (2,14,16,18,20,22,25,
26,28,30,32,34,36,38,40,42,44,46,48,50,51,53,54,56,58,60,62,64,66,
69,71,73,75,77,79,80,82,84,86,88,90,91,94,103,109,111,113,121,142,
143,161,181,241,242,401,441,462,481,482,483,484,485,486,487,488,489,
490,491,492,493,494,496,497,498,499,500,501,502,503,504,505,506,507,508,
509,510,511,512,513,514,515,516,517,518,519,520,521,522,523,524,
525,542,583,621,622,623,625,626,628,630,631,632,633,634,636,637,
638,639,640,642,643,645,646,647,648,650,651,652,653,679,689,701,
721,722,741,742,743,745,746,747,748,749,750,751,752,753,754,755,
756,757,758,759,760,761,762,763,764,766,767,768,769,770,771,772,
773,774,775,823,824,841,842,843,844,845,846,847,848,849,850,851,
853,854,855,871,881,921,981,1021,1061,1101,1141,1181,1241,1261,
1262,1301,1401,1422,1461,1561,1581,1583,1601,1605,1645,1646,1705,
1725,1746,1805,1845,1865,1885,1905,1925,1945,1948,2005,2088,
2090,2091,2105,2111,2112,2126,2226,2245,2246,2265,2346,2427)
ORDER BY 3
