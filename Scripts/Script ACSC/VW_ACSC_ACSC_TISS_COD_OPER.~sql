CREATE OR REPLACE VIEW VW_ACSC_ACSC_TISS_COD_OPER AS (

  SELECT 
        CASE WHEN IRAMB.TP_PAGAMENTO = 'P' THEN '88888' 
             WHEN IRAMB.TP_PAGAMENTO = 'C' AND ATEND.TP_ATENDIMENTO IN ('A','E','I') THEN  '30109'
             ELSE '30110'
             END COD_OPERADORA,
             ATEND.CD_ATENDIMENTO
             FROM 
             ITREG_AMB IRAMB 
             INNER JOIN ATENDIME ATEND ON ATEND.CD_ATENDIMENTO = IRAMB.CD_ATENDIMENTO 
             AND ATEND.CD_PRESTADOR = IRAMB.CD_PRESTADOR
      
             
     
)
;

GRANT SELECT ON VW_ACSC_ACSC_TISS_COD_OPER TO dbaMV
;    

--SELECT X.COD_OPERADORA FROM VW_ACSC_ACSC_TISS_COD_OPER X WHERE X.CD_ATENDIMENTO = :PAR3
