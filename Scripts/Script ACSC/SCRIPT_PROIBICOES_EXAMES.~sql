SELECT 
upper('exame analises clinicas')TIPO_EXAME,
EXL.CD_EXA_LAB COD_EXAME,
EXL.CD_PRO_FAT||' - '||PF.DS_PRO_FAT DS_PROCEDIMENTO,
PB.CD_CONVENIO||' - '||CONV.NM_CONVENIO NM_CONVENIO,
PB.CD_CON_PLA COD_PLANO,
DECODE (PB.TP_PROIBICAO,'AG','Autorizado por Guia')TIPO_PROIBICAO 
FROM EXA_LAB EXL 
INNER JOIN PROIBICAO PB ON PB.CD_PRO_FAT = EXL.CD_PRO_FAT
INNER JOIN PRO_FAT PF ON PF.CD_PRO_FAT = EXL.CD_PRO_FAT
INNER JOIN CONVENIO CONV ON CONV.CD_CONVENIO = PB.CD_CONVENIO 
WHERE EXL.SN_ATIVO = 'S'
AND EXL.CD_PRO_FAT IS NOT NULL 
AND PB.TP_PROIBICAO = 'AG'
AND PB.TP_ATENDIMENTO = 'U'
AND PB.CD_MULTI_EMPRESA = 7

UNION ALL

SELECT 
upper('exame imagens')TIPO_EXAME,
EXR.CD_EXA_RX COD_EXAME,
EXR.EXA_RX_CD_PRO_FAT||' - '||PF.DS_PRO_FAT DS_PROCEDIMENTO,
PB.CD_CONVENIO||' - '||CONV.NM_CONVENIO NM_CONVENIO,
PB.CD_CON_PLA COD_PLANO,
DECODE (PB.TP_PROIBICAO,'AG','Autorizado por Guia')TIPO_PROIBICAO 
FROM EXA_RX EXR
INNER JOIN PROIBICAO PB ON PB.CD_PRO_FAT = EXR.EXA_RX_CD_PRO_FAT
INNER JOIN PRO_FAT PF ON PF.CD_PRO_FAT = EXR.EXA_RX_CD_PRO_FAT
INNER JOIN CONVENIO CONV ON CONV.CD_CONVENIO = PB.CD_CONVENIO 
WHERE EXR.SN_ATIVO = 'S'
AND EXR.EXA_RX_CD_PRO_FAT IS NOT NULL
AND PB.TP_PROIBICAO = 'AG'
AND PB.TP_ATENDIMENTO = 'U'
AND PB.CD_MULTI_EMPRESA = 7 
ORDER BY TIPO_EXAME,NM_CONVENIO,COD_PLANO    
