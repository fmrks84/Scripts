--SELECT * FROM CONVENIO WHERE CD_CONVENIO = 213
select * from pacote where cd_convenio = 213

INSERT INTO PACOTE (CD_PACOTE,CD_MULTI_EMPRESA,CD_CONVENIO,CD_CON_PLA,CD_PRO_FAT,CD_PRO_FAT_PACOTE,DT_VIGENCIA,CD_TIP_ACOM,CD_SETOR,TP_ATENDIMENTO,QT_DIARIAS,VL_PERC_PAC_SECUND,TP_EXTRA,SN_GUIA,QT_PARCELAS,SN_AUTOMATICO,DS_OBSERVACAO,DT_VIGENCIA_FINAL,NR_IDADE_MAXIMA,TP_COBRANCA_PAC_SECUND,VL_PERC_PAC_SECUND_2,VL_PERC_PAC_SECUND_3,VL_PERC_PAC_SECUND_4,CD_TIPO_INTERNACAO,SN_VALIDA_AUTORIZACAO,SN_DAY_CLINIC,VL_PERC_ACRES_GEMELARES,VL_PERC_DESC_RN_UTI,SN_CONSIDERA_HORA,SN_PROTOCOLO_DE_PACOTE,NR_IMC_INICIAL,NR_IMC_FINAL,SN_OBITO,SN_GEMELAR,SN_DIARIA_GABARITO,TP_DISPERCAO,SN_NAO_INTERVENCIONISTA,SN_LANCA_NO_FECHAMENTO,SN_PACOTE_PRO_FAT,SN_PROFAT_DESCARACTERIZA,SN_PROC_FORA_PACOTE)
(SELECT SEQ_PACOTE.NEXTVAL,CD_MULTI_EMPRESA,213,CD_CON_PLA,CD_PRO_FAT,CD_PRO_FAT_PACOTE,DT_VIGENCIA,CD_TIP_ACOM,CD_SETOR,TP_ATENDIMENTO,QT_DIARIAS,VL_PERC_PAC_SECUND,TP_EXTRA,SN_GUIA,QT_PARCELAS,SN_AUTOMATICO,DS_OBSERVACAO,DT_VIGENCIA_FINAL,NR_IDADE_MAXIMA,TP_COBRANCA_PAC_SECUND,VL_PERC_PAC_SECUND_2,VL_PERC_PAC_SECUND_3,VL_PERC_PAC_SECUND_4,CD_TIPO_INTERNACAO,SN_VALIDA_AUTORIZACAO,SN_DAY_CLINIC,VL_PERC_ACRES_GEMELARES,VL_PERC_DESC_RN_UTI,SN_CONSIDERA_HORA,SN_PROTOCOLO_DE_PACOTE,NR_IMC_INICIAL,NR_IMC_FINAL,SN_OBITO,SN_GEMELAR,SN_DIARIA_GABARITO,TP_DISPERCAO,SN_NAO_INTERVENCIONISTA,SN_LANCA_NO_FECHAMENTO,SN_PACOTE_PRO_FAT,SN_PROFAT_DESCARACTERIZA,SN_PROC_FORA_PACOTE FROM 
PACOTE WHERE CD_CONVENIO = 48 AND DT_VIGENCIA_FINAL IS NULL)


update pacote set dt_vigencia_Final = '09/12/2022'
where cd_convenio = 213 


select * from pacote where cd_convenio = 213

SELECT * FROM PACOTE_EXCECAO WHERE CD_PACOTE IN (SELECT CD_PACOTE FROM PACOTE WHERE CD_CONVENIO = 48)ORDER BY 2

SELECT 
B.CD_PRO_FAT,
B.CD_PRO_FAT_PACOTE,
'----',
A.CD_PACOTE_EXCECAO,
A.CD_PACOTE,
A.CD_GRU_PRO,
A.CD_PRO_FAT,
A.CD_SETOR,
A.CD_TIP_ACOM
FROM PACOTE_EXCECAO A 
left JOIN PACOTE B ON B.CD_PACOTE = A.CD_PACOTE
WHERE B.CD_CONVENIO in (48)
AND B.DT_VIGENCIA_FINAL IS NULL
ORDER BY 1

SELECT CD_PRO_FAT, CD_PRO_FAT_PACOTE, CD_PACOTE FROM PACOTE WHERE CD_CONVENIO = 213 
ORDER BY 2 --AND DT_VIGENCIA_FINAL IS NULL


SELECT CD_PRO_FAT,CD_PACOTE FROM PACOTE WHERE CD_CONVENIO = 213 AND DT_VIGENCIA_FINAL IS NULL ORDER BY 1

INSERT INTO PACOTE_EXCECAO (CD_PACOTE_EXCECAO,CD_PACOTE,CD_GRU_PRO,CD_PRO_FAT,CD_SETOR,CD_TIP_ACOM)
VALUES (SEQ_PACOTE_EXCECAO.NEXTVAL,20816,NULL,NULL,107,NULL)
