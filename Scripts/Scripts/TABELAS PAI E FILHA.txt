/*TABELAS PAIS*/
SELECT DISTINCT C_PK.TABLE_NAME TABLE_NAME,
                CAST(A.COLUMN_NAME AS VARCHAR(100)) AS MAINCOLUMNNAME,
                A.CONSTRAINT_NAME,
                A.POSITION,
                A.TABLE_NAME AS R_TABLE_NAME,
                C_PK.CONSTRAINT_NAME R_PK,
                CAST((SELECT AX.COLUMN_NAME
                        FROM ALL_CONS_COLUMNS AX
                       WHERE AX.OWNER = C_PK.OWNER
                         AND AX.CONSTRAINT_NAME = C_PK.CONSTRAINT_NAME
                         AND AX.POSITION = A.POSITION) AS VARCHAR(100)) AS COLUMN_NAME
  FROM ALL_CONS_COLUMNS A
 INNER JOIN ALL_CONSTRAINTS C
    ON A.OWNER = C.OWNER
   AND A.CONSTRAINT_NAME = C.CONSTRAINT_NAME
 INNER JOIN ALL_CONSTRAINTS C_PK
    ON C.R_OWNER = C_PK.OWNER
   AND C.R_CONSTRAINT_NAME = C_PK.CONSTRAINT_NAME
 WHERE C.CONSTRAINT_TYPE = 'R'
 AND A.TABLE_NAME = 'DET_LOG_IMP_CUSTOS'
 ORDER BY TABLE_NAME, CONSTRAINT_NAME, POSITION
       



UNION ALL


/*TABELAS FILHAS*/
SELECT A.TABLE_NAME,
       CAST(A.COLUMN_NAME AS VARCHAR(100)) AS COLUMN_NAME,
       A.CONSTRAINT_NAME,
       A.POSITION,
       C_PK.TABLE_NAME R_TABLE_NAME,
       C_PK.CONSTRAINT_NAME R_PK,
       CAST((SELECT AX.COLUMN_NAME
               FROM ALL_CONS_COLUMNS AX
              WHERE AX.OWNER = C_PK.OWNER
                AND AX.CONSTRAINT_NAME = C_PK.CONSTRAINT_NAME
                AND AX.POSITION = A.POSITION) AS VARCHAR(100)) AS MAINCOLUMNNAME
  FROM ALL_CONS_COLUMNS A
  JOIN ALL_CONSTRAINTS C
    ON A.OWNER = C.OWNER
   AND A.CONSTRAINT_NAME = C.CONSTRAINT_NAME
  JOIN ALL_CONSTRAINTS C_PK
    ON C.R_OWNER = C_PK.OWNER
   AND C.R_CONSTRAINT_NAME = C_PK.CONSTRAINT_NAME
 WHERE C.CONSTRAINT_TYPE = 'R'
   AND C_PK.TABLE_NAME = 'DET_LOG_IMP_CUSTOS'
 ORDER BY TABLE_NAME, CONSTRAINT_NAME, POSITION
